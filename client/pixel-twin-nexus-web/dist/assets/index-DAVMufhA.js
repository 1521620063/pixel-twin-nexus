import{_ as e,z as a,V as t,A as l,B as o,C as n,v as s,D as i,w as r,x as u,E as d,s as c,a as v,F as p,t as f,u as m,G as _,H as g,I as b,q as y,l as h,i as w,J as C,c as x,M as V,m as T,o as S,K as U,e as P,L as R,N as k,O as G,P as I,y as B}from"./index-BrAQZWud.js";import{c as E,f as N,p as O,u as z,ab as W,J as M,L as $,ay as A,j as q,A as X,G as Y,m as j,h as H,n as J,s as L,k as F,F as D}from"./ui-DPCHhl7L.js";import{V as K}from"./VSelect-hpT9jQ5K.js";import{V as Z}from"./VTooltip-DJHSWIpg.js";import{b as Q,e as ee,D as ae,Z as te,W as le,n as oe,X as ne,y as se,Y as ie,v as re,ab as ue,ac as de,P as ce,F as ve,a6 as pe,V as fe,K as me,q as _e,s as ge,j as be,t as ye,O as he,p as we,d as Ce,I as xe,S as Ve}from"./vendor-bgb2fARM.js";const Te=E("v-code","code"),Se={class:"tab-content"},Ue={class:"config-field-wrapper"},Pe={class:"d-flex align-center"},Re={class:"config-field-wrapper"},ke={class:"d-flex align-center"},Ge={class:"config-field-wrapper"},Ie={class:"d-flex align-center"},Be={class:"text-subtitle-1"},Ee={class:"config-field-wrapper"},Ne={class:"config-field-wrapper mt-3"},Oe={class:"config-field-wrapper mt-3"},ze={__name:"WebRTCConfig",setup(e,{expose:_}){const g=Q(!1),b=Q(!1),y=Q(!1),h=Q(null),{showSuccess:w,showError:C,showWarning:x}=m(),V=Q({peerConnectionOptions:{iceTransportPolicy:"all",bundlePolicy:"balanced",rtcpMuxPolicy:"require",iceServers:[{urls:"stun:stun.l.google.com:19302"}]}}),T=[{title:"All",value:"all",description:"收集所有类型的 ICE 候选者",icon:"mdi-select-all"},{title:"Relay",value:"relay",description:"仅收集中继类型的 ICE 候选者",icon:"mdi-relay"}],S=[{title:"Balanced",value:"balanced",description:"平衡的媒体流打包策略",icon:"mdi-scale-balance"},{title:"Max Compat",value:"max-compat",description:"最大兼容性的打包策略",icon:"mdi-check-network"},{title:"Max Bundle",value:"max-bundle",description:"最大打包的策略",icon:"mdi-package-variant-closed"}],U=[{title:"Require",value:"require",description:"要求 RTCP 和 RTP 复用",icon:"mdi-merge"},{title:"Negotiate",value:"negotiate",description:"协商 RTCP 和 RTP 复用",icon:"mdi-handshake"}],P={required:e=>!!e||"此字段为必填项",url:e=>{if(!e)return!0;return/^(stun|turn|turns):[\w.-]+:\d+$/.test(e)||"请输入有效的 STUN/TURN 服务器 URL"}},R=ee(()=>JSON.stringify(V.value,null,2)),k=()=>{},G=()=>{V.value.peerConnectionOptions.iceServers.push({urls:""})},I=async()=>{try{await navigator.clipboard.writeText(R.value),w("WebRTC 配置已复制到剪贴板")}catch(e){C("复制失败")}},B=async()=>{g.value=!0;try{const e=await f.config.getConfig();if(200!=e.code)throw new Error("配置数据格式错误");V.value=e.data,h.value=JSON.parse(JSON.stringify(e.data)),w("WebRTC 配置加载成功")}catch(e){C(e.message||"加载 WebRTC 配置失败")}finally{g.value=!1}};return ae(async()=>{await B()}),_({loadConfig:B,saveConfig:async()=>{if(y.value){b.value=!0;try{if(200!=(await f.config.saveConfig({data:V.value})).code)throw new Error("保存 WebRTC 配置失败");h.value=JSON.parse(JSON.stringify(V.value)),w("WebRTC 配置保存成功"),await B()}catch(e){C(e.message||"保存 WebRTC 配置失败")}finally{b.value=!1}}else x("请检查 WebRTC 配置项是否填写正确")}}),(e,f)=>(le(),te("div",Se,[oe(c,{class:"config-section mb-6",elevation:"0",variant:"flat"},{default:ne(()=>[oe(a,{class:"d-flex align-center"},{default:ne(()=>[oe(t,{class:"mr-3",color:"primary"},{default:ne(()=>f[4]||(f[4]=[ie("mdi-video-wireless")])),_:1,__:[4]}),f[6]||(f[6]=se("span",{class:"text-h5"},"WebRTC 连接配置",-1)),oe(l),oe(o,{color:"primary",variant:"tonal",size:"small"},{default:ne(()=>f[5]||(f[5]=[ie(" PeerConnection Options ")])),_:1,__:[5]})]),_:1,__:[6]}),oe(n),oe(s,{class:"py-6"},{default:ne(()=>[oe(i,{ref:"configForm",modelValue:y.value,"onUpdate:modelValue":f[3]||(f[3]=e=>y.value=e)},{default:ne(()=>[oe(r,null,{default:ne(()=>[oe(u,{cols:"12",md:"6"},{default:ne(()=>[se("div",Ue,[oe(K,{modelValue:V.value.peerConnectionOptions.iceTransportPolicy,"onUpdate:modelValue":[f[0]||(f[0]=e=>V.value.peerConnectionOptions.iceTransportPolicy=e),k],items:T,label:"ICE 传输策略",variant:"outlined","prepend-inner-icon":"mdi-network",rules:[P.required]},{item:ne(({props:e,item:a})=>[oe(d,ue(de(e)),{title:ne(()=>[se("div",Pe,[oe(t,{class:"mr-2",size:"small"},{default:ne(()=>[ie(ce(a.raw.icon),1)]),_:2},1024),ie(" "+ce(a.raw.title),1)])]),subtitle:ne(()=>[ie(ce(a.raw.description),1)]),_:2},1040)]),append:ne(()=>[oe(Z,{location:"top"},{activator:ne(({props:e})=>[oe(t,re(e,{color:"info",size:"small"}),{default:ne(()=>f[7]||(f[7]=[ie("mdi-information-outline")])),_:2,__:[7]},1040)]),default:ne(()=>[f[8]||(f[8]=se("div",{class:"tooltip-content"},[se("div",{class:"text-subtitle-2 mb-1"},"ICE 传输策略说明"),se("div",{class:"text-body-2"},[ie(" 控制 WebRTC 连接时 ICE 候选者的收集策略："),se("br"),ie(" • "),se("strong",null,"All"),ie("：收集所有类型候选者（本地、反射、中继）"),se("br"),ie(" • "),se("strong",null,"Relay"),ie("：仅收集中继候选者以增强隐私保护 ")])],-1))]),_:1,__:[8]})]),_:1},8,["modelValue","rules"])])]),_:1}),oe(u,{cols:"12",md:"6"},{default:ne(()=>[se("div",Re,[oe(K,{modelValue:V.value.peerConnectionOptions.bundlePolicy,"onUpdate:modelValue":[f[1]||(f[1]=e=>V.value.peerConnectionOptions.bundlePolicy=e),k],items:S,label:"Bundle 策略",variant:"outlined","prepend-inner-icon":"mdi-package-variant",rules:[P.required]},{item:ne(({props:e,item:a})=>[oe(d,ue(de(e)),{title:ne(()=>[se("div",ke,[oe(t,{class:"mr-2",size:"small"},{default:ne(()=>[ie(ce(a.raw.icon),1)]),_:2},1024),ie(" "+ce(a.raw.title),1)])]),subtitle:ne(()=>[ie(ce(a.raw.description),1)]),_:2},1040)]),append:ne(()=>[oe(Z,{location:"top"},{activator:ne(({props:e})=>[oe(t,re(e,{color:"info",size:"small"}),{default:ne(()=>f[9]||(f[9]=[ie("mdi-information-outline")])),_:2,__:[9]},1040)]),default:ne(()=>[f[10]||(f[10]=se("div",{class:"tooltip-content"},[se("div",{class:"text-subtitle-2 mb-1"},"Bundle 策略说明"),se("div",{class:"text-body-2"},[ie(" 控制多个媒体流的打包传输策略："),se("br"),ie(" • "),se("strong",null,"Balanced"),ie("：平衡性能和兼容性"),se("br"),ie(" • "),se("strong",null,"Max Compat"),ie("：最大兼容性但可能增加延迟"),se("br"),ie(" • "),se("strong",null,"Max Bundle"),ie("：最大打包减少网络开销 ")])],-1))]),_:1,__:[10]})]),_:1},8,["modelValue","rules"])])]),_:1}),oe(u,{cols:"12",md:"6"},{default:ne(()=>[se("div",Ge,[oe(K,{modelValue:V.value.peerConnectionOptions.rtcpMuxPolicy,"onUpdate:modelValue":[f[2]||(f[2]=e=>V.value.peerConnectionOptions.rtcpMuxPolicy=e),k],items:U,label:"RTCP 复用策略",variant:"outlined","prepend-inner-icon":"mdi-merge",rules:[P.required]},{item:ne(({props:e,item:a})=>[oe(d,ue(de(e)),{title:ne(()=>[se("div",Ie,[oe(t,{class:"mr-2",size:"small"},{default:ne(()=>[ie(ce(a.raw.icon),1)]),_:2},1024),ie(" "+ce(a.raw.title),1)])]),subtitle:ne(()=>[ie(ce(a.raw.description),1)]),_:2},1040)]),append:ne(()=>[oe(Z,{location:"top"},{activator:ne(({props:e})=>[oe(t,re(e,{color:"info",size:"small"}),{default:ne(()=>f[11]||(f[11]=[ie("mdi-information-outline")])),_:2,__:[11]},1040)]),default:ne(()=>[f[12]||(f[12]=se("div",{class:"tooltip-content"},[se("div",{class:"text-subtitle-2 mb-1"},"RTCP 复用策略说明"),se("div",{class:"text-body-2"},[ie(" 控制 RTCP（实时传输控制协议）和 RTP（实时传输协议）的复用方式："),se("br"),ie(" • "),se("strong",null,"Require"),ie("：强制复用减少端口使用"),se("br"),ie(" • "),se("strong",null,"Negotiate"),ie("：协商决定是否复用 ")])],-1))]),_:1,__:[12]})]),_:1},8,["modelValue","rules"])])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),oe(c,{class:"config-section mb-6",elevation:"2"},{default:ne(()=>[oe(a,{class:"d-flex align-center"},{default:ne(()=>[oe(t,{class:"mr-3",color:"info"},{default:ne(()=>f[13]||(f[13]=[ie("mdi-server-network")])),_:1,__:[13]}),f[15]||(f[15]=se("span",{class:"text-h5"},"ICE 服务器配置",-1)),oe(l),oe(v,{color:"primary",variant:"tonal",size:"small","prepend-icon":"mdi-plus",onClick:G},{default:ne(()=>f[14]||(f[14]=[ie(" 添加服务器 ")])),_:1,__:[14]})]),_:1,__:[15]}),oe(n),oe(s,{class:"py-6"},{default:ne(()=>[oe(r,null,{default:ne(()=>[(le(!0),te(ve,null,pe(V.value.peerConnectionOptions.iceServers,(e,o)=>(le(),fe(u,{key:o,cols:"12",md:"6",lg:"4"},{default:ne(()=>[oe(c,{class:"ice-server-card",variant:"outlined",elevation:"1"},{default:ne(()=>[oe(a,{class:"d-flex align-center py-3"},{default:ne(()=>[oe(t,{class:"mr-2",color:"info",size:"small"},{default:ne(()=>f[16]||(f[16]=[ie("mdi-server")])),_:1,__:[16]}),se("span",Be,"ICE 服务器 "+ce(o+1),1),oe(l),oe(v,{icon:"mdi-delete",size:"x-small",color:"error",variant:"text",onClick:e=>(e=>{V.value.peerConnectionOptions.iceServers.length>1&&V.value.peerConnectionOptions.iceServers.splice(e,1)})(o),disabled:V.value.peerConnectionOptions.iceServers.length<=1},null,8,["onClick","disabled"])]),_:2},1024),oe(n),oe(s,{class:"py-4"},{default:ne(()=>[se("div",Ee,[oe(p,{modelValue:e.urls,"onUpdate:modelValue":[a=>e.urls=a,k],label:"服务器 URL",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-link",rules:[P.required,P.url],placeholder:"stun:stun.example.com:19302"},{append:ne(()=>[oe(Z,{location:"top"},{activator:ne(({props:e})=>[oe(t,re({ref_for:!0},e,{color:"info",size:"small"}),{default:ne(()=>f[17]||(f[17]=[ie("mdi-information-outline")])),_:2,__:[17]},1040)]),default:ne(()=>[f[18]||(f[18]=se("div",{class:"tooltip-content"},[se("div",{class:"text-subtitle-2 mb-1"},"服务器 URL 格式"),se("div",{class:"text-body-2"},[ie(" • "),se("strong",null,"STUN 服务器"),ie("：stun:域名:端口"),se("br"),ie(" • "),se("strong",null,"TURN 服务器"),ie("：turn:域名:端口"),se("br"),ie(" • "),se("strong",null,"TURNS 服务器"),ie("：turns:域名:端口（安全连接） ")])],-1))]),_:1,__:[18]})]),_:2},1032,["modelValue","onUpdate:modelValue","rules"])]),se("div",Ne,[oe(p,{modelValue:e.username,"onUpdate:modelValue":[a=>e.username=a,k],label:"用户名 (可选)",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-account"},{append:ne(()=>[oe(Z,{location:"top"},{activator:ne(({props:e})=>[oe(t,re({ref_for:!0},e,{color:"info",size:"small"}),{default:ne(()=>f[19]||(f[19]=[ie("mdi-information-outline")])),_:2,__:[19]},1040)]),default:ne(()=>[f[20]||(f[20]=se("div",{class:"tooltip-content"},[se("div",{class:"text-subtitle-2 mb-1"},"用户名说明"),se("div",{class:"text-body-2"}," TURN 服务器认证用户名，STUN 服务器通常不需要此字段 ")],-1))]),_:1,__:[20]})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),se("div",Oe,[oe(p,{modelValue:e.credential,"onUpdate:modelValue":[a=>e.credential=a,k],label:"凭证 (可选)",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-key",type:"password"},{append:ne(()=>[oe(Z,{location:"top"},{activator:ne(({props:e})=>[oe(t,re({ref_for:!0},e,{color:"info",size:"small"}),{default:ne(()=>f[21]||(f[21]=[ie("mdi-information-outline")])),_:2,__:[21]},1040)]),default:ne(()=>[f[22]||(f[22]=se("div",{class:"tooltip-content"},[se("div",{class:"text-subtitle-2 mb-1"},"凭证说明"),se("div",{class:"text-body-2"}," TURN 服务器认证密码或令牌，STUN 服务器通常不需要此字段 ")],-1))]),_:1,__:[22]})]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1}),oe(c,{class:"config-preview mb-6",elevation:"2"},{default:ne(()=>[oe(a,{class:"d-flex align-center"},{default:ne(()=>[oe(t,{class:"mr-3",color:"secondary"},{default:ne(()=>f[23]||(f[23]=[ie("mdi-code-json")])),_:1,__:[23]}),f[25]||(f[25]=se("span",{class:"text-h5"},"WebRTC 配置预览",-1)),oe(l),oe(v,{color:"secondary",variant:"tonal",size:"small","prepend-icon":"mdi-content-copy",onClick:I},{default:ne(()=>f[24]||(f[24]=[ie(" 复制配置 ")])),_:1,__:[24]})]),_:1,__:[25]}),oe(n),oe(s,{class:"py-4"},{default:ne(()=>[oe(Te,{class:"config-code"},{default:ne(()=>[se("pre",null,ce(R.value),1)]),_:1})]),_:1})]),_:1})]))}},We=e(ze,[["__scopeId","data-v-a68f4fbf"]]),Me={class:"tab-content"},$e={class:"config-field-wrapper mb-4"},Ae={class:"d-flex justify-space-between align-center mb-3"},qe={class:"text-subtitle-2"},Xe={class:"config-field-wrapper mb-3"},Ye={class:"config-field-wrapper"},je=e({__name:"GPUConfig",setup(e,{expose:d}){const _=Q(!1),g=Q(!1),b=Q(!1),y=Q(null),{showSuccess:h,showError:w,showWarning:C}=m(),x=Q({ip:"127.0.0.1",gpu:[{graphicsAdapter:0,gpuMemory:0}]}),V={required:e=>!!e||"此字段为必填项",requiredNumber:e=>null!=e&&""!==e||"此字段为必填项",positiveNumber:e=>{if(!e)return!0;return parseFloat(e)>0||"请输入大于0的数值"},nonNegativeNumber:e=>{if(""===e||null==e)return!0;return parseFloat(e)>=0||"请输入大于等于0的数值"},ip:e=>{if(!e)return!0;return/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)||"请输入有效的 IP 地址"}},T=ee(()=>JSON.stringify(x.value,null,2)),S=()=>{},U=async()=>{try{await navigator.clipboard.writeText(T.value),h("GPU 配置已复制到剪贴板")}catch(e){w("复制失败")}},P=async()=>{_.value=!0;try{const e=await f.config.getGpuConfig();if(200!=e.code)throw new Error("GPU 配置数据格式错误");{const a=e.data||{ip:"localhost",gpu:[{graphicsAdapter:0,gpuMemory:0}]};x.value=a,y.value=JSON.parse(JSON.stringify(x.value)),h("GPU 配置加载成功")}}catch(e){w(e.message||"加载 GPU 配置失败")}finally{_.value=!1}};return ae(async()=>{await P()}),d({loadGpuConfig:P,saveGpuConfig:async()=>{if(b.value){g.value=!0;try{if(200!=(await f.config.saveGpuConfig({data:x.value})).code)throw new Error("保存 GPU 配置失败");y.value=JSON.parse(JSON.stringify(x.value)),h("GPU 配置保存成功"),await P()}catch(e){w(e.message||"保存 GPU 配置失败")}finally{g.value=!1}}else C("请检查 GPU 配置项是否填写正确")}}),(e,d)=>(le(),te("div",Me,[oe(c,{class:"config-section mb-6",elevation:"0",variant:"flat"},{default:ne(()=>[oe(a,{class:"d-flex align-center"},{default:ne(()=>[oe(t,{class:"mr-3",color:"primary"},{default:ne(()=>d[3]||(d[3]=[ie("mdi-expansion-card")])),_:1,__:[3]}),d[5]||(d[5]=se("span",{class:"text-h5"},"GPU 配置管理",-1)),oe(l),oe(o,{color:"primary",variant:"tonal",size:"small"},{default:ne(()=>d[4]||(d[4]=[ie(" Graphics Processing Unit ")])),_:1,__:[4]})]),_:1,__:[5]}),oe(n),oe(s,{class:"py-6"},{default:ne(()=>[oe(i,{ref:"gpuConfigForm",modelValue:b.value,"onUpdate:modelValue":d[2]||(d[2]=e=>b.value=e)},{default:ne(()=>[oe(r,null,{default:ne(()=>[oe(u,{cols:"12"},{default:ne(()=>[oe(c,{class:"server-card mb-4",variant:"outlined",elevation:"2"},{default:ne(()=>[oe(a,{class:"d-flex align-center py-3"},{default:ne(()=>[oe(t,{class:"mr-2",color:"info",size:"small"},{default:ne(()=>d[6]||(d[6]=[ie("mdi-server")])),_:1,__:[6]}),d[7]||(d[7]=se("span",{class:"text-subtitle-1"},"GPU 服务器",-1))]),_:1,__:[7]}),oe(n),oe(s,{class:"py-4"},{default:ne(()=>[se("div",$e,[oe(p,{modelValue:x.value.ip,"onUpdate:modelValue":d[0]||(d[0]=e=>x.value.ip=e),label:"服务器 IP 地址",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-ip-network",rules:[V.required,V.ip],placeholder:"例如：192.168.1.100",disabled:""},{append:ne(()=>[oe(Z,{location:"top"},{activator:ne(({props:e})=>[oe(t,re(e,{color:"info",size:"small"}),{default:ne(()=>d[8]||(d[8]=[ie("mdi-information-outline")])),_:2,__:[8]},1040)]),default:ne(()=>[d[9]||(d[9]=se("div",{class:"tooltip-content"},[se("div",{class:"text-subtitle-2 mb-1"},"服务器 IP 说明"),se("div",{class:"text-body-2"}," GPU 服务器的 IP 地址，用于网络连接和通信 ")],-1))]),_:1,__:[9]})]),_:1},8,["modelValue","rules"])]),oe(n,{class:"my-4"}),se("div",Ae,[d[11]||(d[11]=se("h4",{class:"text-h6"},"GPU 设备",-1)),oe(v,{color:"primary",variant:"tonal",size:"small","prepend-icon":"mdi-plus",onClick:d[1]||(d[1]=e=>{x.value.gpu.push({graphicsAdapter:0,gpuMemory:0})})},{default:ne(()=>d[10]||(d[10]=[ie(" 添加 GPU ")])),_:1,__:[10]})]),oe(r,null,{default:ne(()=>[(le(!0),te(ve,null,pe(x.value.gpu,(e,o)=>(le(),fe(u,{key:o,cols:"12",md:"6",lg:"4"},{default:ne(()=>[oe(c,{class:"gpu-device-card",variant:"outlined",elevation:"1"},{default:ne(()=>[oe(a,{class:"d-flex align-center py-3"},{default:ne(()=>[oe(t,{class:"mr-2",color:"primary",size:"small"},{default:ne(()=>d[12]||(d[12]=[ie("mdi-expansion-card")])),_:1,__:[12]}),se("span",qe,"GPU "+ce(o+1),1),oe(l),oe(v,{icon:"mdi-delete",size:"x-small",color:"error",variant:"text",onClick:e=>(e=>{x.value.gpu.splice(e,1)})(o)},null,8,["onClick"])]),_:2},1024),oe(n),oe(s,{class:"py-3"},{default:ne(()=>[se("div",Xe,[oe(p,{modelValue:e.graphicsAdapter,"onUpdate:modelValue":[a=>e.graphicsAdapter=a,S],modelModifiers:{number:!0},label:"显卡适配器索引",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-numeric",type:"number",rules:[V.requiredNumber,V.nonNegativeNumber],placeholder:"例如：0"},{append:ne(()=>[oe(Z,{location:"top"},{activator:ne(({props:e})=>[oe(t,re({ref_for:!0},e,{color:"info",size:"small"}),{default:ne(()=>d[13]||(d[13]=[ie("mdi-information-outline")])),_:2,__:[13]},1040)]),default:ne(()=>[d[14]||(d[14]=se("div",{class:"tooltip-content"},[se("div",{class:"text-subtitle-2 mb-1"},"显卡适配器索引说明"),se("div",{class:"text-body-2"}," GPU 在系统中的适配器索引，通常从 0 开始编号 ")],-1))]),_:1,__:[14]})]),_:2},1032,["modelValue","onUpdate:modelValue","rules"])]),se("div",Ye,[oe(p,{modelValue:e.gpuMemory,"onUpdate:modelValue":[a=>e.gpuMemory=a,S],modelModifiers:{number:!0},label:"显存大小 (GB)",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-memory",type:"number",rules:[V.required,V.positiveNumber],placeholder:"例如：16"},{append:ne(()=>[oe(Z,{location:"top"},{activator:ne(({props:e})=>[oe(t,re({ref_for:!0},e,{color:"info",size:"small"}),{default:ne(()=>d[15]||(d[15]=[ie("mdi-information-outline")])),_:2,__:[15]},1040)]),default:ne(()=>[d[16]||(d[16]=se("div",{class:"tooltip-content"},[se("div",{class:"text-subtitle-2 mb-1"},"显存大小说明"),se("div",{class:"text-body-2"}," GPU 的显存容量，单位为 GB，用于渲染和计算任务 ")],-1))]),_:1,__:[16]})]),_:2},1032,["modelValue","onUpdate:modelValue","rules"])])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),oe(c,{class:"config-preview mb-6",elevation:"2"},{default:ne(()=>[oe(a,{class:"d-flex align-center"},{default:ne(()=>[oe(t,{class:"mr-3",color:"secondary"},{default:ne(()=>d[17]||(d[17]=[ie("mdi-code-json")])),_:1,__:[17]}),d[19]||(d[19]=se("span",{class:"text-h5"},"GPU 配置预览",-1)),oe(l),oe(v,{color:"secondary",variant:"tonal",size:"small","prepend-icon":"mdi-content-copy",onClick:U},{default:ne(()=>d[18]||(d[18]=[ie(" 复制配置 ")])),_:1,__:[18]})]),_:1,__:[19]}),oe(n),oe(s,{class:"py-4"},{default:ne(()=>[oe(Te,{class:"config-code"},{default:ne(()=>[se("pre",null,ce(T.value),1)]),_:1})]),_:1})]),_:1})]))}},[["__scopeId","data-v-76aa6c15"]]),He=Symbol.for("vuetify:v-tabs"),Je=O({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...W(b({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),Le=N()({name:"VTab",props:Je(),setup(e,a){let{slots:t,attrs:l}=a;const{textColorClasses:o,textColorStyles:n}=_(()=>e.sliderColor),s=Q(),i=Q(),r=ee(()=>"horizontal"===e.direction),u=ee(()=>s.value?.group?.isSelected.value??!1);function d(e){let{value:a}=e;if(a){const e=s.value?.$el.parentElement?.querySelector(".v-tab--selected .v-tab__slider"),a=i.value;if(!e||!a)return;const t=getComputedStyle(e).color,l=e.getBoundingClientRect(),o=a.getBoundingClientRect(),n=r.value?"x":"y",u=r.value?"X":"Y",d=r.value?"right":"bottom",c=r.value?"width":"height",v=l[n]>o[n]?l[d]-o[d]:l[n]-o[n],p=Math.sign(v)>0?r.value?"right":"bottom":Math.sign(v)<0?r.value?"left":"top":"center",f=(Math.abs(v)+(Math.sign(v)<0?l[c]:o[c]))/Math.max(l[c],o[c])||0,m=l[c]/o[c]||0,_=1.5;M(a,{backgroundColor:[t,"currentcolor"],transform:[`translate${u}(${v}px) scale${u}(${m})`,`translate${u}(${v/_}px) scale${u}(${(f-1)/_+1})`,"none"],transformOrigin:Array(3).fill(p)},{duration:225,easing:$})}}return z(()=>{const a=v.filterProps(e);return oe(v,re({symbol:He,ref:s,class:["v-tab",e.class],style:e.style,tabindex:u.value?0:-1,role:"tab","aria-selected":String(u.value),active:!1},a,l,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":d}),{...t,default:()=>se(ve,null,[t.default?.()??e.text,!e.hideSlider&&se("div",{ref:i,class:_e(["v-tab__slider",o.value]),style:me(n.value)},null)])})}),g({},s)}});function Fe(e,a){const t=e.changedTouches[0];a.touchendX=t.clientX,a.touchendY=t.clientY,a.end?.({originalEvent:e,...a}),(e=>{const{touchstartX:a,touchendX:t,touchstartY:l,touchendY:o}=e;e.offsetX=t-a,e.offsetY=o-l,Math.abs(e.offsetY)<.5*Math.abs(e.offsetX)&&(e.left&&t<a-16&&e.left(e),e.right&&t>a+16&&e.right(e)),Math.abs(e.offsetX)<.5*Math.abs(e.offsetY)&&(e.up&&o<l-16&&e.up(e),e.down&&o>l+16&&e.down(e))})(a)}const De={mounted:function(e,a){const t=a.value,l=t?.parent?e.parentElement:e,o=t?.options??{passive:!0},n=a.instance?.$.uid;if(!l||!n)return;const s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:e.left,right:e.right,up:e.up,down:e.down,start:e.start,move:e.move,end:e.end};return{touchstart:e=>function(e,a){const t=e.changedTouches[0];a.touchstartX=t.clientX,a.touchstartY=t.clientY,a.start?.({originalEvent:e,...a})}(e,a),touchend:e=>Fe(e,a),touchmove:e=>function(e,a){const t=e.changedTouches[0];a.touchmoveX=t.clientX,a.touchmoveY=t.clientY,a.move?.({originalEvent:e,...a})}(e,a)}}(a.value);l._touchHandlers=l._touchHandlers??Object.create(null),l._touchHandlers[n]=s,A(s).forEach(e=>{l.addEventListener(e,s[e],o)})},unmounted:function(e,a){const t=a.value?.parent?e.parentElement:e,l=a.instance?.$.uid;if(!t?._touchHandlers||!l)return;const o=t._touchHandlers[l];A(o).forEach(e=>{t.removeEventListener(e,o[e])}),delete t._touchHandlers[l]}},Ke=Symbol.for("vuetify:v-window"),Ze=Symbol.for("vuetify:v-window-group"),Qe=O({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:e=>"boolean"==typeof e||"hover"===e},verticalArrows:[Boolean,String],touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...H(),...h(),...j()},"VWindow"),ea=N()({name:"VWindow",directives:{vTouch:De},props:Qe(),emits:{"update:modelValue":e=>!0},setup(e,a){let{slots:t}=a;const{themeClasses:l}=q(e),{isRtl:o}=X(),{t:n}=Y(),s=y(e,Ze),i=Q(),r=ee(()=>o.value?!e.reverse:e.reverse),u=ge(!1),d=ee(()=>`v-window-${"vertical"===e.direction?"y":"x"}${(r.value?!u.value:u.value)?"-reverse":""}-transition`),c=ge(0),p=Q(void 0),f=ee(()=>s.items.value.findIndex(e=>s.selected.value.includes(e.id)));be(f,(e,a)=>{const t=s.items.value.length,l=t-1;u.value=t<=2?e<a:e===l&&0===a||(0!==e||a!==l)&&e<a}),we(Ke,{transition:d,isReversed:u,transitionCount:c,transitionHeight:p,rootRef:i});const m=ye(()=>e.continuous||0!==f.value),_=ye(()=>e.continuous||f.value!==s.items.value.length-1);function g(){m.value&&s.prev()}function b(){_.value&&s.next()}const h=ee(()=>{const a=[],l={icon:o.value?e.nextIcon:e.prevIcon,class:"v-window__"+(r.value?"right":"left"),onClick:s.prev,"aria-label":n("$vuetify.carousel.prev")};a.push(m.value?t.prev?t.prev({props:l}):oe(v,l,null):se("div",null,null));const i={icon:o.value?e.prevIcon:e.nextIcon,class:"v-window__"+(r.value?"left":"right"),onClick:s.next,"aria-label":n("$vuetify.carousel.next")};return a.push(_.value?t.next?t.next({props:i}):oe(v,i,null):se("div",null,null)),a}),w=ee(()=>{if(!1===e.touch)return e.touch;return{...{left:()=>{r.value?g():b()},right:()=>{r.value?b():g()},start:e=>{let{originalEvent:a}=e;a.stopPropagation()}},...!0===e.touch?{}:e.touch}});return z(()=>he(oe(e.tag,{ref:i,class:_e(["v-window",{"v-window--show-arrows-on-hover":"hover"===e.showArrows,"v-window--vertical-arrows":!!e.verticalArrows},l.value,e.class]),style:me(e.style)},{default:()=>[se("div",{class:"v-window__container",style:{height:p.value}},[t.default?.({group:s}),!1!==e.showArrows&&se("div",{class:_e(["v-window__controls",{"v-window__controls--left":"left"===e.verticalArrows||!0===e.verticalArrows},{"v-window__controls--right":"right"===e.verticalArrows}])},[h.value])]),t.additional?.({group:s})]}),[[De,w.value]])),{group:s}}}),aa=O({...W(Qe(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),ta=N()({name:"VTabsWindow",props:aa(),emits:{"update:modelValue":e=>!0},setup(e,a){let{slots:t}=a;const l=Ce(He,null),o=J(e,"modelValue"),n=ee({get:()=>null==o.value&&l?l.items.value.find(e=>l.selected.value.includes(e.id))?.value:o.value,set(e){o.value=e}});return z(()=>{const a=ea.filterProps(e);return oe(ea,re({_as:"VTabsWindow"},a,{modelValue:n.value,"onUpdate:modelValue":e=>n.value=e,class:["v-tabs-window",e.class],style:e.style,mandatory:!1,touch:!1}),t)}),{}}}),la=O({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...H(),...S(),...T()},"VWindowItem"),oa=N()({name:"VWindowItem",directives:{vTouch:De},props:la(),emits:{"group:selected":e=>!0},setup(e,a){let{slots:t}=a;const l=Ce(Ke),o=w(e,Ze),{isBooted:n}=C();if(!l||!o)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const s=ge(!1),i=ee(()=>n.value&&(l.isReversed.value?!1!==e.reverseTransition:!1!==e.transition));function r(){s.value&&l&&(s.value=!1,l.transitionCount.value>0&&(l.transitionCount.value-=1,0===l.transitionCount.value&&(l.transitionHeight.value=void 0)))}function u(){!s.value&&l&&(s.value=!0,0===l.transitionCount.value&&(l.transitionHeight.value=L(l.rootRef.value?.clientHeight)),l.transitionCount.value+=1)}function d(){r()}function c(e){s.value&&xe(()=>{i.value&&s.value&&l&&(l.transitionHeight.value=L(e.clientHeight))})}const v=ee(()=>{const a=l.isReversed.value?e.reverseTransition:e.transition;return!!i.value&&{name:"string"!=typeof a?l.transition.value:a,onBeforeEnter:u,onAfterEnter:r,onEnterCancelled:d,onBeforeLeave:u,onAfterLeave:r,onLeaveCancelled:d,onEnter:c}}),{hasContent:p}=x(e,o.isSelected);return z(()=>oe(V,{transition:v.value,disabled:!n.value},{default:()=>[he(se("div",{class:_e(["v-window-item",o.selectedClass.value,e.class]),style:me(e.style)},[p.value&&t.default?.()]),[[Ve,o.isSelected.value]])]})),{groupItem:o}}}),na=O({...la()},"VTabsWindowItem"),sa=N()({name:"VTabsWindowItem",props:na(),setup(e,a){let{slots:t}=a;return z(()=>{const a=oa.filterProps(e);return oe(oa,re({_as:"VTabsWindowItem"},a,{class:["v-tabs-window-item",e.class],style:e.style}),t)}),{}}});const ia=O({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...I({mandatory:"force",selectedClass:"v-tab-item--selected"}),...G(),...h()},"VTabs"),ra=N()({name:"VTabs",props:ia(),emits:{"update:modelValue":e=>!0},setup(e,a){let{attrs:t,slots:l}=a;const o=J(e,"modelValue"),n=ee(()=>function(e){return e?e.map(e=>D(e)?e:{text:e,value:e}):[]}(e.items)),{densityClasses:s}=U(e),{backgroundColorClasses:i,backgroundColorStyles:r}=P(()=>e.bgColor),{scopeId:u}=R();return F({VTab:{color:ye(()=>e.color),direction:ye(()=>e.direction),stacked:ye(()=>e.stacked),fixed:ye(()=>e.fixedTabs),sliderColor:ye(()=>e.sliderColor),hideSlider:ye(()=>e.hideSlider)}}),z(()=>{const a=k.filterProps(e),d=!!(l.window||e.items.length>0);return se(ve,null,[oe(k,re(a,{modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},s.value,i.value,e.class],style:[{"--v-tabs-height":L(e.height)},r.value,e.style],role:"tablist",symbol:He},u,t),{default:()=>[l.default?.()??n.value.map(e=>l.tab?.({item:e})??oe(Le,re(e,{key:e.text,value:e.value}),{default:l[`tab.${e.value}`]?()=>l[`tab.${e.value}`]?.({item:e}):void 0}))]}),d&&oe(ta,re({modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,key:"tabs-window"},u),{default:()=>[n.value.map(e=>l.item?.({item:e})??oe(sa,{value:e.value},{default:()=>l[`item.${e.value}`]?.({item:e})})),l.window?.()]})])}),{}}}),ua={class:"config-management-view"},da={class:"d-flex align-center justify-space-between"},ca={class:"d-flex align-center"},va={class:"d-flex gap-4"},pa=e({__name:"index",setup(e){const a=Q("webrtc"),l=Q(!1),o=Q(!1),i=Q(null),r=Q(null),{showError:u}=m(),d=ee(()=>!0),p=()=>"webrtc"===a.value?i.value:"gpu"===a.value?r.value:null,f=async()=>{const e=p();if(e){l.value=!0;try{"webrtc"===a.value&&e.loadConfig?await e.loadConfig():"gpu"===a.value&&e.loadGpuConfig?await e.loadGpuConfig():u("当前组件不支持加载配置")}catch(t){u("加载配置失败")}finally{l.value=!1}}else u("未找到当前配置组件")},_=async()=>{const e=p();if(e){o.value=!0;try{"webrtc"===a.value&&e.saveConfig?await e.saveConfig():"gpu"===a.value&&e.saveGpuConfig?await e.saveGpuConfig():u("当前组件不支持保存配置")}catch(t){u("保存配置失败")}finally{o.value=!1}}else u("未找到当前配置组件")};return(e,u)=>(le(),te("div",ua,[oe(c,{class:"page-header mb-6",elevation:"3"},{default:ne(()=>[oe(s,{class:"py-6"},{default:ne(()=>[se("div",da,[se("div",ca,[oe(B,{size:"64",color:"primary",class:"mr-4"},{default:ne(()=>[oe(t,{size:"32",color:"white"},{default:ne(()=>u[2]||(u[2]=[ie("mdi-cog-outline")])),_:1,__:[2]})]),_:1}),u[3]||(u[3]=se("div",null,[se("h1",{class:"text-h4 font-weight-bold mb-1 text-primary"}," 配置管理中心 "),se("p",{class:"text-body-1 text-medium-emphasis mb-0"}," 管理和配置 Pixel Twin 系统参数 ")],-1))]),se("div",va,[oe(v,{color:"success",variant:"elevated","prepend-icon":"mdi-content-save",onClick:_,loading:o.value,disabled:!d.value,class:"save-btn"},{default:ne(()=>u[4]||(u[4]=[ie(" 保存配置 ")])),_:1,__:[4]},8,["loading","disabled"]),u[6]||(u[6]=ie("   ")),oe(v,{color:"warning",variant:"outlined","prepend-icon":"mdi-refresh",onClick:f,loading:l.value,class:"refresh-btn"},{default:ne(()=>u[5]||(u[5]=[ie(" 重新加载 ")])),_:1,__:[5]},8,["loading"])])])]),_:1})]),_:1}),oe(c,{class:"config-tabs-container",elevation:"2"},{default:ne(()=>[oe(ra,{modelValue:a.value,"onUpdate:modelValue":u[0]||(u[0]=e=>a.value=e),class:"config-tabs",color:"primary","align-tabs":"start"},{default:ne(()=>[oe(Le,{value:"webrtc",class:"tab-item"},{default:ne(()=>[oe(t,{class:"mr-2"},{default:ne(()=>u[7]||(u[7]=[ie("mdi-video-wireless")])),_:1,__:[7]}),u[8]||(u[8]=ie(" WebRTC 配置 "))]),_:1,__:[8]}),oe(Le,{value:"gpu",class:"tab-item"},{default:ne(()=>[oe(t,{class:"mr-2"},{default:ne(()=>u[9]||(u[9]=[ie("mdi-expansion-card")])),_:1,__:[9]}),u[10]||(u[10]=ie(" GPU 配置 "))]),_:1,__:[10]})]),_:1},8,["modelValue"]),oe(n),oe(ta,{modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=e=>a.value=e),class:"config-tabs-window"},{default:ne(()=>[oe(sa,{value:"webrtc"},{default:ne(()=>[oe(We,{ref_key:"webrtcConfigRef",ref:i},null,512)]),_:1}),oe(sa,{value:"gpu"},{default:ne(()=>[oe(je,{ref_key:"gpuConfigRef",ref:r},null,512)]),_:1})]),_:1},8,["modelValue"])]),_:1})]))}},[["__scopeId","data-v-c9eab29e"]]);export{pa as default};
